#' Make linked table of contents in markdown
#'
#' This function takes a markdown file and creates links for every section in the table of contents (TOC).
#'
#' @importFrom tools file_ext
#' @param path Character. Path to the markdown file.
#' @export
#' @return A markdown file.
#' @author Tyler Rinker
#' @seealso \link{https://github.com/trinker/testing_Rmd} & \link{http://stackoverflow.com/questions/29997263/linked-table-of-contents-toc-in-md-using-rmarkdown}

md_toc <- function(path = {(x <- dir())[tools::file_ext(x) == "md"]}){
  x <- suppressWarnings(readLines(path))
  inds <- 1:(which(!grepl("^\\s*-", x))[1] - 1)
  temp <- gsub("(^[ -]+)(.+)", "\\1", x[inds])
  content <- gsub("^[ -]+", "", x[inds])
  x[inds] <- sprintf("%s[%s](#%s)", temp, content, gsub("\\s", "-", tolower(content)))
  cat(paste(x, collapse = "\n"), file = path)
}
